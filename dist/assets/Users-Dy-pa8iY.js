import{S as q,r as D,_ as W,v as $,g as L,o as H,y as U,c as w,b as C,e as s,d as t,t as f,u as d,l as K,w as p,f as h,j as b,E as S,h as Q,I as m,Z as M,J as Z,F as z,p as X,K as N}from"./index-Dt4dB-s4.js";const Y=q("user",()=>{const u=D([{name:"John Doe",assignedDevice:"iPhone#25",employeeId:"1654656",role:"Manager",deviceGroups:"Day Shift Managers, Staff, Office Staff",status:"Available",category:"A1"},{name:"John Doe",assignedDevice:"iPhone#25",employeeId:"1654656",role:"Manager",deviceGroups:"Day Shift Managers, Staff, Office Staff",status:"In Use",category:"A2"},{name:"Jane Smith",assignedDevice:"Android#18",employeeId:"7890123",role:"Staff",deviceGroups:"Staff, Night Shift",status:"Available",category:"A1"},{name:"Mike Ross",assignedDevice:"iPad#09",employeeId:"4567890",role:"Admin",deviceGroups:"Admin, Office Staff",status:"Damaged",category:"A3"},{name:"Alice Brown",assignedDevice:"MacBook#05",employeeId:"2345678",role:"Supervisor",deviceGroups:"Supervisor, Day Shift",status:"In Use",category:"A2"},{name:"Bob Wilson",assignedDevice:"Android#20",employeeId:"3456789",role:"Staff",deviceGroups:"Staff, Day Shift",status:"Available",category:"A4"},{name:"Charlie Davis",assignedDevice:"iPad#10",employeeId:"5678901",role:"Admin",deviceGroups:"Admin, IT Staff",status:"In Use",category:"A3"},{name:"Eve Miller",assignedDevice:"iPhone#26",employeeId:"6789012",role:"Manager",deviceGroups:"Night Shift Managers, Staff",status:"Damaged",category:"A4"},{name:"Frank Lee",assignedDevice:"Tablet#15",employeeId:"7890124",role:"Staff",deviceGroups:"Staff, Weekend Shift",status:"Available",category:"A1"}]);return{userList:u,addUser:i=>{u.value.push(i)},updateUser:(i,g)=>{i>=0&&i<u.value.length&&(u.value[i]={...u.value[i],...g})},deleteUser:i=>{i>=0&&i<u.value.length&&u.value.splice(i,1)}}}),ee={class:"users-page"},ae={class:"header-row"},se={class:"page-title"},le={class:"header-actions"},te={class:"filter-section"},de={class:"user-cards mobile-cards"},oe={class:"card-row data-row"},ie={class:"card-cell"},re={class:"cell-value"},ce={class:"card-cell"},ne={class:"cell-value"},ve={class:"card-cell"},ue={class:"cell-value"},pe={class:"card-row data-row"},fe={class:"card-cell"},me={class:"cell-value"},ge={class:"card-cell"},ye={class:"cell-value"},he={class:"card-cell"},be={class:"cell-value"},Se={class:"card-row data-row"},_e={class:"card-cell action-cell",style:{"grid-column":"1 / -1"}},De={class:"cell-value"},Ae=Object.assign({name:"Users"},{__name:"Users",setup(u){const A=$(),v=Y(),I=L(()=>v.userList);H(()=>{const a=history.state;console.log("Users页面 onMounted - state:",a),a&&a.action&&(a.action==="add"&&a.userData?(console.log("添加新用户:",a.userData),v.addUser(a.userData),U.success("User added successfully!")):a.action==="update"&&a.userData&&a.index>=0?(console.log("更新用户 - 索引:",a.index,"数据:",a.userData),console.log("更新前的用户:",v.userList[a.index]),v.updateUser(a.index,a.userData),console.log("更新后的用户:",v.userList[a.index]),U.success("User updated successfully!")):a.action==="delete"&&a.index>=0&&(console.log("删除用户 - 索引:",a.index),v.deleteUser(a.index),U.success("User deleted successfully!")),history.replaceState({},document.title))});const i=D(""),g=D(""),O={backgroundColor:"#C7EDFF",color:"#000",fontWeight:"bold"},_=L(()=>{let a=[...I.value];if(g.value&&(a=a.filter(e=>e.category===g.value)),i.value){const e=i.value.toLowerCase();a=a.filter(l=>Object.entries(l).some(([o,r])=>o!=="category"&&r&&r.toString().toLowerCase().includes(e)))}return a}),E=D(null),j=()=>{E.value.click()},F=a=>{const e=a.target.files[0];if(!e)return;const l=new FileReader;e.name.endsWith(".csv")?(l.onload=o=>{const r=o.target.result,c=B(r);c&&(v.userList=c,a.target.value="")},l.readAsText(e)):e.name.endsWith(".json")?(l.onload=o=>{try{const r=JSON.parse(o.target.result);Array.isArray(r)?(v.userList=r,a.target.value=""):alert("Invalid JSON format. Expected an array.")}catch(r){alert("Error parsing JSON file: "+r.message)}},l.readAsText(e)):alert("Unsupported file format. Please upload CSV or JSON.")},B=a=>{try{const e=a.split(`
`).filter(n=>n.trim());if(e.length<2)return alert("CSV file is empty or has no data."),null;const l=e[0].split(",").map(n=>n.trim()),o=["name","assignedDevice","employeeId","role","deviceGroups","status"],r=o.filter(n=>!l.some(y=>y.toLowerCase()===n));if(r.length>0)return alert(`CSV file is missing required columns: ${r.join(", ")}`),null;const c=[];for(let n=1;n<e.length;n++){const y=e[n].split(","),k={};l.forEach((R,P)=>{var V;const G=R.toLowerCase();o.includes(G)&&(k[G]=((V=y[P])==null?void 0:V.trim())||"")}),c.push(k)}return c}catch(e){return alert("Error parsing CSV file: "+e.message),null}},J=()=>{const a=_.value,e=["name","assignedDevice","employeeId","role","deviceGroups","status"],l=[e.join(","),...a.map(n=>e.map(y=>n[y]||"").join(","))].join(`
`),o=new Blob([l],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(o),c=document.createElement("a");c.setAttribute("href",r),c.setAttribute("download","users_export.csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)},T=()=>{A.push({name:"Users_all_edit",query:{mode:"add"}})},x=(a,e)=>{const l=I.value.findIndex(o=>o.name===a.name&&o.employeeId===a.employeeId&&o.role===a.role);console.log("编辑用户 - 过滤索引:",e,"真实索引:",l),console.log("用户数据:",a),A.push({name:"Users_all_edit",query:{mode:"edit",index:l,name:a.name,employeeId:a.employeeId,role:a.role,assignedDevice:a.assignedDevice,deviceGroups:a.deviceGroups,status:a.status,category:a.category||"",badgeId:a.badgeId||"",pin:a.pin||""}})};return(a,e)=>(C(),w("div",ee,[s("div",ae,[s("h1",se,"Users ("+f(_.value.length)+")",1),s("div",le,[t(d(K),{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l),placeholder:"Search",style:{width:"200px"},clearable:""},null,8,["modelValue"]),t(d(b),{class:"import-btn",onClick:j},{default:p(()=>[...e[2]||(e[2]=[h(" Import File ",-1)])]),_:1}),t(d(b),{class:"export-btn",onClick:J},{default:p(()=>[...e[3]||(e[3]=[h(" Export File ",-1)])]),_:1}),t(d(b),{type:"primary",class:"add-user-btn",onClick:T},{default:p(()=>[...e[4]||(e[4]=[h("Add New User",-1)])]),_:1}),s("input",{ref_key:"fileInput",ref:E,type:"file",style:{display:"none"},accept:".csv,.json",onChange:F},null,544)])]),s("div",te,[t(d(Q),{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),placeholder:"All Categories",clearable:"",style:{width:"200px"}},{default:p(()=>[t(d(S),{label:"All Categories",value:""}),t(d(S),{label:"A1",value:"A1"}),t(d(S),{label:"A2",value:"A2"}),t(d(S),{label:"A3",value:"A3"}),t(d(S),{label:"A4",value:"A4"})]),_:1},8,["modelValue"])]),t(d(Z),{data:_.value,border:"","header-cell-style":O,class:"users-table desktop-table"},{default:p(()=>[t(d(m),{prop:"name",label:"Name"}),t(d(m),{prop:"assignedDevice",label:"Assigned Device"}),t(d(m),{prop:"employeeId",label:"Employee ID"}),t(d(m),{prop:"role",label:"Role"}),t(d(m),{prop:"deviceGroups",label:"Device Groups"}),t(d(m),{prop:"status",label:"Status"}),t(d(m),{label:"Operation",align:"center"},{default:p(l=>[t(d(b),{type:"primary",plain:"",class:"edit-btn",onClick:M(o=>x(l.row,l.$index),["prevent"])},{default:p(()=>[...e[5]||(e[5]=[h(" Edit ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),s("div",de,[(C(!0),w(z,null,X(_.value,(l,o)=>(C(),w("div",{key:o,class:"user-card"},[e[11]||(e[11]=N('<div class="card-row header-row-card" data-v-2897ce9c><div class="card-cell" data-v-2897ce9c><div class="cell-label" data-v-2897ce9c>Name</div></div><div class="card-divider-vertical" data-v-2897ce9c></div><div class="card-cell" data-v-2897ce9c><div class="cell-label" data-v-2897ce9c>Assigned Device</div></div><div class="card-divider-vertical" data-v-2897ce9c></div><div class="card-cell" data-v-2897ce9c><div class="cell-label" data-v-2897ce9c>Employee ID</div></div></div>',1)),s("div",oe,[s("div",ie,[s("div",re,f(l.name),1)]),e[6]||(e[6]=s("div",{class:"card-divider-vertical"},null,-1)),s("div",ce,[s("div",ne,f(l.assignedDevice),1)]),e[7]||(e[7]=s("div",{class:"card-divider-vertical"},null,-1)),s("div",ve,[s("div",ue,f(l.employeeId),1)])]),e[12]||(e[12]=N('<div class="card-row header-row-card" data-v-2897ce9c><div class="card-cell" data-v-2897ce9c><div class="cell-label" data-v-2897ce9c>Role</div></div><div class="card-divider-vertical" data-v-2897ce9c></div><div class="card-cell" data-v-2897ce9c><div class="cell-label" data-v-2897ce9c>Device Groups</div></div><div class="card-divider-vertical" data-v-2897ce9c></div><div class="card-cell" data-v-2897ce9c><div class="cell-label" data-v-2897ce9c>Status</div></div></div>',1)),s("div",pe,[s("div",fe,[s("div",me,f(l.role),1)]),e[8]||(e[8]=s("div",{class:"card-divider-vertical"},null,-1)),s("div",ge,[s("div",ye,f(l.deviceGroups),1)]),e[9]||(e[9]=s("div",{class:"card-divider-vertical"},null,-1)),s("div",he,[s("div",be,f(l.status),1)])]),e[13]||(e[13]=s("div",{class:"card-row header-row-card"},[s("div",{class:"card-cell",style:{"grid-column":"1 / -1"}},[s("div",{class:"cell-label"},"Operation")])],-1)),s("div",Se,[s("div",_e,[s("div",De,[t(d(b),{type:"primary",plain:"",class:"edit-btn-mobile",onClick:M(r=>x(l,o),["prevent"])},{default:p(()=>[...e[10]||(e[10]=[h(" Edit ",-1)])]),_:1},8,["onClick"])])])])]))),128))])]))}}),Ue=W(Ae,[["__scopeId","data-v-2897ce9c"]]);export{Ue as default};
