import{m as t,ad as k,q as I,r as d,a as y,d as n,ae as S,$ as m,af as g,t as w,J as x,b as L,_ as q}from"./index-COfldkwK.js";import{a as A}from"./index-B9ygI19o.js";const B="/assets/1_2-DvPToQTL.png",p=A.create({baseURL:"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});p.interceptors.request.use(e=>{const a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${a}`),e},e=>(console.error("Request error:",e),Promise.reject(e)));p.interceptors.response.use(e=>e,e=>{var a;if(e.response)switch(e.response.status){case 401:localStorage.removeItem("token"),localStorage.removeItem("userInfo"),localStorage.removeItem("isAuthenticated"),k.push("/login"),t.error("登录已过期，请重新登录");break;case 403:t.error("没有权限访问");break;case 404:t.error("请求的资源不存在");break;case 500:t.error("服务器错误");break;default:t.error(((a=e.response.data)==null?void 0:a.msg)||"请求失败")}else e.code==="ECONNABORTED"?t.error("请求超时，请稍后重试"):t.error("网络错误，请检查网络连接");return Promise.reject(e)});function P(e){return p.post("/login/login",e)}const T={class:"login-container"},D={class:"form-container"},E=["disabled"],M=I({__name:"login",setup(e){const a=x(),l=d(""),i=d(""),u=d(!1),f=async()=>{var c;if(!l.value||!i.value){t.error("请输入账号和密码");return}try{u.value=!0;const s={account:l.value,password:i.value},o=await P(s);if(console.log("登录响应：",o.data),o.data.ret===0&&o.data.code==="200"){const{token:r,uid:v,type:b,menu:_}=o.data.ret_data||{};r&&localStorage.setItem("token",r);const h={uid:v,type:b,account:l.value,menu:_};localStorage.setItem("userInfo",JSON.stringify(h)),localStorage.setItem("isAuthenticated","true"),t.success("Login successful！"),a.push("/dashboard")}else{let r="登录失败";switch(o.data.code){case"201":r="用户不存在";break;case"400":r="密码错误";break;default:r=o.data.msg||"登录失败"}t.error(r)}}catch(s){console.error("登录错误：",s),s.response?t.error(((c=s.response.data)==null?void 0:c.msg)||"登录失败，请稍后重试"):t.error("网络错误，请检查网络连接")}finally{u.value=!1}};return(c,s)=>(L(),y("div",T,[s[3]||(s[3]=n("img",{src:B,alt:"HonestWaves Icon",class:"login-icon"},null,-1)),n("div",D,[s[2]||(s[2]=n("h2",{class:"sub-title"},"Admin Portal",-1)),n("form",{class:"login-form",onSubmit:S(f,["prevent"])},[m(n("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>l.value=o),type:"text",class:"form-input",placeholder:"Username",required:""},null,512),[[g,l.value]]),m(n("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>i.value=o),type:"password",class:"form-input",placeholder:"Password",required:""},null,512),[[g,i.value]]),n("button",{type:"submit",class:"login-btn",disabled:u.value},w(u.value?"Loading...":"Login"),9,E)],32)])]))}}),U=q(M,[["__scopeId","data-v-d73b1884"]]);export{U as default};
