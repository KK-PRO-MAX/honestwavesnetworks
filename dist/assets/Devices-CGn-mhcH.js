import{_ as G,J as H,r as k,c as S,o as X,v as Y,z as ee,a as N,b as E,d as i,e as l,t as p,u as t,j as ae,w as n,E as c,f as R,g as f,h as y,O as _,P as le,F as te,l as ie,Q as U,m as A}from"./index-COfldkwK.js";import{u as de}from"./deviceStore-BOybtG8z.js";import{u as se}from"./filterStore-wW98jmOu.js";import"./device-p3qppuv_.js";import"./index-B9ygI19o.js";const ce={class:"device-management-page"},oe={class:"header-row"},ne={class:"page-title"},re={class:"header-actions"},ve={class:"filter-section"},ue={class:"device-cards mobile-cards"},pe={class:"card-row data-row"},_e={class:"card-cell"},be={class:"cell-value"},me={class:"card-cell"},fe={class:"cell-value"},ye={class:"card-cell"},he={class:"cell-value"},ge={class:"card-row data-row"},Ce={class:"card-cell"},De={class:"cell-value"},we={class:"card-cell"},ke={class:"cell-value"},Ae={class:"card-cell action-cell"},xe={class:"cell-value"},Ie={__name:"Devices",setup(Le){const O=H(),v=de(),T=se(),x=k(""),b=k("All"),h=S({get:()=>T.selectedCategory,set:a=>T.setCategory(a)}),V=k(null),W=k(1),j={backgroundColor:"#0C306C",color:"#fff",fontWeight:"bold"},g=S(()=>{const a=x.value.trim().toLowerCase();return v.deviceList.filter(e=>a?String(e.device_id).toLowerCase().includes(a)||String(e.device_name).toLowerCase().includes(a)||String(e.device_type).toLowerCase().includes(a)||e.device_nfc_code&&String(e.device_nfc_code).toLowerCase().includes(a):!0)});S(()=>`Devices (${g.value.length})`);const z=()=>{C()},Z=()=>{C()},q=()=>{C()},C=async()=>{try{const a={page:W.value};if(b.value&&b.value!=="All"){const o={iPhone:1,iPad:2,Laptop:3,"Android Phone":4,"Android Tablet":5,Zebra:6}[b.value];o!==void 0&&(a.device_type_id=o)}if(h.value){const e=parseInt(h.value,10);isNaN(e)||(a.locker_id=e)}await v.loadDeviceList(a),console.log("è®¾å¤‡åˆ—è¡¨å·²åŠ è½½:",v.deviceList)}catch(a){console.error("è®¾å¤‡åˆ—è¡¨åŠ è½½å¤±è´¥:",a)}},P=async()=>{console.log("ðŸ”„ Devices initializing data..."),await C()};X(async()=>{console.log("ðŸ”„ Devices onMounted - component mounted"),await P()}),Y(async()=>{console.log("ðŸ”„ Devices onActivated - component activated from cache"),await P()});const $=a=>{O.push({path:"/Devices_all_edit",query:{mode:"edit",id:a.id,device_id:a.device_id,device_name:a.device_name,device_type_id:a.device_type_id,device_nfc_code:a.device_nfc_code,cabinet_no:a.cabinet_no,locker_id:a.locker_id}})},J=()=>{var a;(a=V.value)==null||a.click()},K=async a=>{const e=a.target.files[0];if(!e)return;const o=new FileReader;o.onload=d=>{var s,m,r,F,B,M;try{const I=d.target.result;if(e.name.endsWith(".csv")){const L=I.split(`
`),D=[];for(let w=1;w<L.length;w++)if(L[w].trim()){const u=L[w].split(",");D.push({device_id:((s=u[0])==null?void 0:s.trim())||"",device_name:((m=u[1])==null?void 0:m.trim())||"",device_type_id:parseInt(((r=u[2])==null?void 0:r.trim())||"0"),device_nfc_code:parseInt(((F=u[3])==null?void 0:F.trim())||"0"),cabinet_no:parseInt(((B=u[4])==null?void 0:B.trim())||"0"),locker_id:parseInt(((M=u[5])==null?void 0:M.trim())||"0")})}D.length>0&&(v.deviceList.length=0,v.deviceList.push(...D),A.success(`Successfully imported ${D.length} devices`))}else(e.name.endsWith(".xlsx")||e.name.endsWith(".xls"))&&A.warning("Excel file import requires the xlsx library. Please use CSV format or install the xlsx library.")}catch(I){console.error("Import failed:",I),A.error("File import failed, please check the file format")}},o.readAsText(e),a.target.value=""},Q=()=>{const a="Device ID,Device Name,Device Type ID,Device NFC Code,Cabinet No,Locker ID",e=v.deviceList.map(r=>`${r.device_id},${r.device_name},${r.device_type_id},${r.device_nfc_code||""},${r.cabinet_no},${r.locker_id}`),o=[a,...e].join(`
`),d=new Blob([o],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),m=URL.createObjectURL(d);s.setAttribute("href",m),s.setAttribute("download",`devices_${new Date().getTime()}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),A.success("Device data exported successfully")};return(a,e)=>{const o=ee("router-link");return E(),N("div",ce,[i("div",oe,[i("h1",ne,"Devices ("+p(g.value.length)+")",1),i("div",re,[l(t(ae),{modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=d=>x.value=d),placeholder:"Search",class:"search-input","prefix-icon":"el-icon-search",onInput:z},null,8,["modelValue"]),l(t(R),{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=d=>b.value=d),placeholder:"Select type",class:"device-type-select",onChange:Z},{default:n(()=>[l(t(c),{label:"All",value:"All"}),l(t(c),{label:"iPhone",value:"iPhone"}),l(t(c),{label:"iPad",value:"iPad"}),l(t(c),{label:"Laptop",value:"Laptop"}),l(t(c),{label:"Android Phone",value:"Android Phone"}),l(t(c),{label:"Android Tablet",value:"Android Tablet"}),l(t(c),{label:"Zebra",value:"Zebra"})]),_:1},8,["modelValue"]),l(t(y),{class:"import-btn",onClick:J},{default:n(()=>[...e[3]||(e[3]=[f("Import File",-1)])]),_:1}),i("input",{ref_key:"fileInput",ref:V,type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},onChange:K},null,544),l(t(y),{class:"export-btn",onClick:Q},{default:n(()=>[...e[4]||(e[4]=[f("Export File",-1)])]),_:1}),l(o,{to:"/Devices_all_edit"},{default:n(()=>[l(t(y),{type:"primary",class:"add-device-btn"},{default:n(()=>[...e[5]||(e[5]=[f("Add New Device",-1)])]),_:1})]),_:1})])]),i("div",ve,[l(t(R),{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=d=>h.value=d),placeholder:"All Categories",clearable:"",style:{width:"200px"},onChange:q},{default:n(()=>[l(t(c),{label:"All Categories",value:""}),l(t(c),{label:"A1",value:"A1"}),l(t(c),{label:"A2",value:"A2"}),l(t(c),{label:"A3",value:"A3"}),l(t(c),{label:"A4",value:"A4"})]),_:1},8,["modelValue"])]),l(t(le),{data:g.value,"header-cell-style":j,class:"device-table desktop-table"},{default:n(()=>[l(t(_),{prop:"device_name",label:"Device Name"}),l(t(_),{prop:"device_id",label:"Device ID"}),l(t(_),{prop:"device_nfc_code",label:"Barcode or NFC*"}),l(t(_),{prop:"device_type",label:"Device Type"}),l(t(_),{prop:"cabinet_no",label:"Cabinet No"}),l(t(_),{label:"Operation",align:"center"},{default:n(d=>[l(t(y),{type:"primary",plain:"",class:"edit-btn",onClick:s=>$(d.row)},{default:n(()=>[...e[6]||(e[6]=[f(" Edit ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),i("div",ue,[(E(!0),N(te,null,ie(g.value,(d,s)=>(E(),N("div",{key:s,class:"device-card"},[e[12]||(e[12]=U('<div class="card-row header-row-card" data-v-3ba761ae><div class="card-cell" data-v-3ba761ae><div class="cell-label" data-v-3ba761ae>Device Name</div></div><div class="card-divider-vertical" data-v-3ba761ae></div><div class="card-cell" data-v-3ba761ae><div class="cell-label" data-v-3ba761ae>Device ID</div></div><div class="card-divider-vertical" data-v-3ba761ae></div><div class="card-cell" data-v-3ba761ae><div class="cell-label" data-v-3ba761ae>Barcode or NFC*</div></div></div>',1)),i("div",pe,[i("div",_e,[i("div",be,p(d.device_name),1)]),e[7]||(e[7]=i("div",{class:"card-divider-vertical"},null,-1)),i("div",me,[i("div",fe,p(d.device_id),1)]),e[8]||(e[8]=i("div",{class:"card-divider-vertical"},null,-1)),i("div",ye,[i("div",he,p(d.device_nfc_code),1)])]),e[13]||(e[13]=U('<div class="card-row header-row-card" data-v-3ba761ae><div class="card-cell" data-v-3ba761ae><div class="cell-label" data-v-3ba761ae>Device Type</div></div><div class="card-divider-vertical" data-v-3ba761ae></div><div class="card-cell" data-v-3ba761ae><div class="cell-label" data-v-3ba761ae>Cabinet No</div></div><div class="card-divider-vertical" data-v-3ba761ae></div><div class="card-cell" data-v-3ba761ae><div class="cell-label" data-v-3ba761ae>Action</div></div></div>',1)),i("div",ge,[i("div",Ce,[i("div",De,p(d.device_type),1)]),e[10]||(e[10]=i("div",{class:"card-divider-vertical"},null,-1)),i("div",we,[i("div",ke,p(d.cabinet_no),1)]),e[11]||(e[11]=i("div",{class:"card-divider-vertical"},null,-1)),i("div",Ae,[i("div",xe,[l(t(y),{type:"primary",plain:"",class:"edit-btn-mobile",onClick:m=>$(d)},{default:n(()=>[...e[9]||(e[9]=[f(" Edit ",-1)])]),_:1},8,["onClick"])])])])]))),128))])])}}},Pe=G(Ie,[["__scopeId","data-v-3ba761ae"]]);export{Pe as default};
